# pyCertLogo
OpenSSL template file generator for embedding pictures or audio logotypes into X.509 digital certificates.
Implements X.509 Public Key Infrastructure (PKI) standard [RFC 9399](https://www.rfc-editor.org/rfc/rfc9399) (“Logotypes in X.509 Certificates”) from May 2023, which obsoletes both [RFC 3709](https://www.rfc-editor.org/rfc/rfc3709) and [RFC 6170](https://www.rfc-editor.org/rfc/rfc6170).
This may also be used for *electronic* certificates, pursuant to [Regulation (UE) №910/2014 “**eIDAS**”](https://digital-strategy.ec.europa.eu/en/policies/eidas-regulation), currently at its final stages of legislative review to transit into **eIDAS2**, which norms European electronic signatures (e-signing), seals (e-sealing), attestations of attribute, electronic ledgers, website authentication certificates (WAC)and other types of electronic trust services.

This tool's  main purpose is help with automated generation of OpenSSL templates for embedding specific logotypes (either images and audio, cfr. below) into either public-key and attribute certificates conforming to the ITU-T X.509 / [RFC 5280](https://www.rfc-editor.org/rfc/rfc5280) standard.

Certificate logos augment the UX of end-user applications and improve the overall *digital trust*, as they provide trusted visual representations of people, organizations, website and/or IT systems which digital certificates are bound to. The digital signature of a CA over such digital certificate also protects the embedded logos/logotypes, thus ensuring their integrity and authenticity together with the rest of the certified data (e.g. a public key or attribute).
A non-exhaustive list of applications for certiticate logos/logotypes/images include:
 * Compositing, on an electronically signed PDF document, the scanned picture of the signatory's (natural person's) **handwritten signature**, derived from the electronic certificate itself. When the e-signed document is printed on paper or viewed on screen, the e-signature's graphics provies a convincing visual representation of the signatory's handwritten signature. Besides, the signature is not pasted from a potentially untrusted image under the control of typesetting writer, but rather parsed from the electronic certificate, as part of the e-signing process under the control of the signatory. Cfr. ETSI [EN 319-142](https://www.etsi.org/deliver/etsi_en/319100_319199/31914201/01.01.01_60/en_31914201v010101p.pdf) “PAdES” standards' family.
 * Compositing, on an electronically sealed PDF document, the **organization**/**federation**/**product**/etc. **logo**types that visually improve both the document's integrity and authenticity. Cfr. considerations from the previous bullet point.
 * Extract, from the identification/authentication certificate in an electronic identification (eID) means (e.g. an ID smartcard), the owner's ICAO-compliant photo. The Authority that e-sealed the above certificate also authenticated the photo (as part of an identity proofing or other KYC technique), enables trusted **identification** by visual or automated comparison with either the photo printed on the ID or visual inspection by a (e.g. customs) officer. This process augments and builds from eID [Passive Authentication](https://www.bsi.bund.de/EN/Themen/Oeffentliche-Verwaltung/Elektronische-Identitaeten/Elektronische-Ausweisdokumente/Sicherheitsmechanismen/Passive-Authentication/passive-authentication_node.html) method (cfr. BSI [TR-03110](https://www.bsi.bund.de/EN/Themen/Unternehmen-und-Organisationen/Standards-und-Zertifizierung/Technische-Richtlinien/TR-nach-Thema-sortiert/tr03110/TR-03110_node.html) standard).
 * As soon as a website (or any other online HTTP resource) is visited, display the logotype of a trusted website's organization directly from its TLS certificate or website authentication certificate (WAC). The web browser performing an independent, out-of-band validation of the WAC (e.g. the [*eIDAS QWAC Validator*](https://addons.mozilla.org/en-US/firefox/addon/eidas-qwac-validator/) plug-in for *Firefox*) may help internet users with **detection of spoofed**/**typosquatted**/**defaced websites**, as the web-browser would show an off-page outcome of the above WAC validation. In this case the logo extracted from the validated WAC provides improved user experience (UX) on the association of the visited page with its legitimate owner (instead of relying on `commonName` or lenghtier-to-read distinguished names in the WAC).
 * Applications processing non-PDF e-sealed documents (e.g. XML, JSON/JWS **messages**, **blockchain** transactions, OAuth/SAML **assertions** or **tokens**), databases (e.g. e-ledgers) or attestation of attributes may extract pictures from the e-sealing certificates. That would augment GUI-driven UX for such documents or processes. Some examples:
     * the GUI icon of a specific, unknown XML file may be better identified in case the operating system composites over the icon one or several badges parsed from its signing certificate, which is associated to e-seals or e-signatures present in, or associated with the document;
     * visual processing of a transaction (e.g. e-payment by means of a payments' card) may include the card's circuit(s) or the service provider's logoype(s) displayed on the web page or the app's UI, as extracted from the authoritative source (e-certificate).

This Python script includes a service class to manipulate Object Identifiers (OIDs) and classes to prepare logos embedding within X.509 certificates. The script's deliverable is sections of a OpenSSL configuration file to generate digital certificates with the embedded logo(s). OpenSSL (or compatible appliations, e.g. [*`xca`*](https://hohnstaedt.de/xca/)) parses a certificate profile internally or externally (e.g. via `.include` statements) referncing such sections from the X509v3 extensions' section.

Other relevant technical standards where certificate logos may improve the overall UX include those on digital signatures (including e-signatures/seals) of the following file formats:
  * ***JSON***: either JSON Web Signature (**JWS** from [RFC 7515](https://rfc-editor.org/rfc/rfc7515)), and “**JAdES**” from the ETSI [TS 119-182](https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf) family.
  * ***XML***: either W3C's XML Digital Signature ([**XML-DSIG**](https://www.w3.org/TR/xmldsig-core2/)), and “**XAdES**” from the ETSI [EN 319-132](https://www.etsi.org/deliver/etsi_en/319100_319199/31913201/01.02.01_60/en_31913201v010201p.pdf) family;

Currently supported file formats for certificate logos are GIF, JPEG, PNG, SVG (and SVGZ), PDF, as well as MP3 (meant to contain logotypes' audio description). This tool checkes for propoed logos metadata to just validate the file formats, but does not perform other checks on the file-based logo files provided via command line. Currently, images are checked for raster size, whereas SVG(Z) are automatically inspected for the correctednes of their SVG dialect). It is, however, up to the user to ensure the files comply with the technical format constrains from the first two aforementioned RFCs.

As a last note, certificate logos may be either “directly” embedded in the X.509 certificate (base64 encoded, supported since [RFC 6170](https://www.rfc-editor.org/rfc/rfc6170), thus considerably increasing the payload size), or “indirectly” referenced from the certificate: the latter means each logotype is externally provided content (e.g. uploaded on a CDN) whereby the certificate contains both that content's URI and one or more of its digests.


## Usage ##
The first argument is the [*filename*] of an OpenSSL-valid configuration file (may also be empty when initially written by the present tool). The file is appended if it already exists.
All other arguments are optional (but at least one is required).;
[-i *filename*]    t    Filename or URI where a valid logotype can be found;
[-s *filename*]    t    Filename or URI where one or more valid logotypes can be found;
[-c *filename*]    t    Filename or URI where one or more valid logotypes can be found;
[-O *oidtypeé -o *filename*]    t    Filename or URI where another-purpose X509 certificate is attached. By default it always comes with an option for outputting to a text file.
